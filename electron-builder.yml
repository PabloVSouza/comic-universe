appId: com.electron.app
productName: Comic Universe
directories:
  buildResources: build
# Publish configuration disabled - we handle publishing manually in workflows
# publish:
#   provider: github
#   owner: PabloVSouza
#   repo: comic-universe

# Disable auto-publishing in CI
publish: null

# Code signing configuration
# For code signing options:
# 1. Apple Developer Program ($99/year) - macOS official certificates
# 2. Microsoft Partner Center (Windows) - Free for open source projects
# 3. Self-signed certificates (free but shows security warnings)
# 4. No code signing (free but shows "unidentified developer" warnings)

files:
  - '**/*'
  - '!**/.vscode/*'
  - '!src/*'
  - '!electron.vite.config.{js,ts,mjs,cjs}'
  - '!{.eslintignore,.eslintrc.cjs,.prettierignore,.prettierrc.yaml,dev-app-update.yml,CHANGELOG.md,README.md}'
  - '!{.env,.env.*,.npmrc,pnpm-lock.yaml}'
  - '!{tsconfig.json,tsconfig.node.json,tsconfig.web.json}'
  - '!*.code-workspace'
  - '!node_modules/prisma/**'
  - '!node_modules/@prisma/**'
  - '!node_modules/.prisma/**'
  - '!node_modules/drizzle-kit/**'
  - '!node_modules/@types/**'
  - '!node_modules/typescript/**'
  - '!node_modules/eslint/**'
  - '!node_modules/prettier/**'
  - '!node_modules/vite/**'
  - '!node_modules/electron-vite/**'
  - '!node_modules/electron-builder/**'
  - '!node_modules/electron-icon-builder/**'
  - '!node_modules/sass-embedded/**'
  - '!node_modules/tailwindcss/**'
  - '!node_modules/autoprefixer/**'
  - '!node_modules/postcss/**'
  - '!node_modules/vite-plugin-svgr/**'
  - '!node_modules/@vitejs/**'
  - '!node_modules/@typescript-eslint/**'
  - '!node_modules/eslint-plugin-**'
  - '!node_modules/globals/**'
  - '!node_modules/@rollup/**'
  - '!node_modules/rollup/**'
  - '!node_modules/@jridgewell/**'
  - '!node_modules/@electron/notarize/**'
  - '!node_modules/@electron-toolkit/tsconfig/**'
  - '!node_modules/@types/better-sqlite3/**'
  - '!node_modules/@types/cors/**'
  - '!node_modules/@types/express/**'
  - '!node_modules/@types/lodash.debounce/**'
  - '!node_modules/@types/node/**'
  - '!node_modules/@types/pacote/**'
  - '!node_modules/@types/react/**'
  - '!node_modules/@types/react-dom/**'
  - '!node_modules/@types/uuid/**'
  - '!node_modules/@emnapi/**'
  - '!node_modules/@tailwindcss/oxide-wasm32-wasi/**'
  - '!node_modules/better-sqlite3/build/Release/test_extension.node'
  - '!node_modules/**/test/**'
  - '!node_modules/**/tests/**'
  - '!node_modules/**/docs/**'
  - '!node_modules/**/examples/**'
  - '!node_modules/**/demo/**'
  - '!node_modules/**/sample/**'
  - '!node_modules/**/*.md'
  - '!node_modules/**/*.txt'
  - '!node_modules/**/*.map'
  - '!node_modules/**/CHANGELOG*'
  - '!node_modules/**/LICENSE*'
  - '!node_modules/**/README*'
asarUnpack:
  - 'node_modules/better-sqlite3/build/Release/better_sqlite3.node'
  - 'resources/*'
  - 'out/database/migrations/**/*'
win:
  executableName: comic-universe
  icon: resources/icon.png
  # Code signing configuration for Windows
  # cscLink: "certificates/windows-cert.p12"  # Local development
  # cscKeyPassword: "comicuniverse"           # Local development

  # Time stamping server
  signAndEditExecutable: false
  
  # Ensure icon is properly embedded
  target:
    - target: nsis
      arch:
        - x64
nsis:
  artifactName: ${name}-${version}-win-${arch}.${ext}
  shortcutName: ${productName}
  uninstallDisplayName: ${productName}
  createDesktopShortcut: always
mac:
  artifactName: ${name}-${version}-mac-${arch}.${ext}
  icon: build/icon.icns
  entitlementsInherit: build/entitlements.mac.plist
  extendInfo:
    - NSCameraUsageDescription: Application requests access to the device's camera.
    - NSMicrophoneUsageDescription: Application requests access to the device's microphone.
    - NSDocumentsFolderUsageDescription: Application requests access to the user's Documents folder.
    - NSDownloadsFolderUsageDescription: Application requests access to the user's Downloads folder.

  # Code signing configuration for macOS
  identity: 'Comic Universe'
  # Certificate file for self-signed certificate (uses environment variables in CI/CD)
  # cscLink: "certificates/macos-cert.p12"  # Local development
  # cscKeyPassword: "comicuniverse"         # Local development

  # Notarization (requires Apple Developer Program)
  notarize: false # Set to true when you have Apple Developer Program access

  # Hardened runtime (required for notarization)
  hardenedRuntime: false

  # Gatekeeper assessment (required for notarization)
  gatekeeperAssess: false
dmg:
  artifactName: ${name}-${version}-mac-${arch}.${ext}
  backgroundColor: '#a0aef8'
  # Optimize DMG creation speed
  format: UDZO
  window:
    width: 540
    height: 380
linux:
  target:
    - AppImage
    - deb
  icon: resources/icon.png
  maintainer: electronjs.org
  category: Utility
appImage:
  artifactName: ${name}-${version}-linux-${arch}.${ext}
npmRebuild: true
# Optimize build size and speed
compression: normal
removePackageScripts: true
removePackageKeywords: true
generateUpdatesFilesForAllChannels: true
buildDependenciesFromSource: false
# Skip problematic dependencies
nodeGypRebuild: false
